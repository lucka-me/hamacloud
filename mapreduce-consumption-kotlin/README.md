# mapreduce-consumption-kotlin

A Hadoop MapReduce implement written in Kotlin with IntelliJ IDEA and built with Gradle.

The `.jar` file generated by IJ will not include Hadoop libraries.

## Descriptions
This implement will:
1. Obtains data from mongoDB, with format like:  
    ```json
    {
        "province": "北京市",
        "city": "北京市",
        "area": "海淀区",
        "price": "20.0"
    }
    ```
2. Calculates average of `price` in every area (based on `province + city + area`)
3. Save the result to mongoDB

## Requirement
- Library (`.jar` files) of Apache Hadoop 3.2.0

## Build
1. In `build.gradle`:
    1. If `System.getenv()` could return the correct path in your os, use it instead of plain string
    2. In `jar {}`, paste the required paths inside `from(zipTree(""))`
2. Open the Gradle panel on the right side, execute `Tasks - build - jar` and the `.jar` file will be located at `build/libs`
3. Send the `.jar` to Hadoop server and run it with following arguments:
    ```bash
    $ ... <mongoDB host> <database name> <input collection> <output collection>
    ```
